BIP-39 (Bitcoin Improvement Proposal 39) визначає механізм генерації
мнемонічної фрази та подальше перетворення її на seed, який уже безпосередньо
використовується для отримання приватних ключів. Його основні складові такі:

1. Генерація мнемонічної фрази.
Мнемонічна фраза, згідно з BIP-39, складається з наперед визначеної
кількості слів зі спеціального словника. Зазвичай використовується набір із
2048 слів, наявний у відкритому доступі (для англійської, японської,
корейської й інших мов). Довжина фрази буває 12, 15, 18, 21 або 24 слова.
Найпоширеніші формати — це 12 або 24 слова. За допомогою
криптографічно захищеного генератора випадкових чисел (CSPRBG)
спочатку отримують початкову бітову послідовність entropy (наприклад, 128
або 256 біт). Далі обчислюється хеш SHA-256(entropy) із якого беруть тільки
перші entropy/32 біти (наприклад, для entropy довжиною 256 біт беруть 8 біт).
Ці біти називаються контрольною сумою. Потім отриману контрольну суму
додають (конкатенують) до вихідних випадкових бітів.
Після додавання контрольної суми загальна довжина бітів стає такою, що її
зручно розбити на групи по 11 біт, що інтерпретуються як число від 0 до 2047
(тобто 211 = 2048 можливих значень). Це число є номером слова у
відповідному BIP-32 словнику. Завдяки такому механізму з одного боку
отримуємо просту для читання й запису мнемоніку, а з іншого – маємо
вбудовану перевірку правильності. Якщо користувач випадково переплутає
одне зі слів або порядок слів, то контрольна сума не співпаде, і при перевірці
мнемоніка розпізнається як некоректна.

2. Перетворення мнемонічної фрази на seed.
Після отримання послідовності слів (мнемоніки) виконується перехід до 512-
бітного seed за допомогою функції PBKDF2-HMAC-SHA512.
На вхід PBKDF2 передають: мнемонічну фразу (словосполучення), так звану
«сіль» (salt), якою є рядок "mnemonic" (за BIP-39) та додаткове парольне
слово (passphrase), якщо користувач обирає його.
Отриманий у результаті 512-бітний seed і є тим головним секретом, із якого
виконується подальше (детерміноване) виведення приватних ключів.
Переваги та безпечність мнемонік:
– Запам’ятати або зберігати мнемонічний ряд зі слів значно простіше, ніж
громіздку бітову послідовність.
– Зі збереженого набору слів користувач у будь-який момент може знову
отримати свій seed і відновити доступ до всіх відповідних приватних ключів.
– Додавання парольної фрази (passphrase) підвищує безпеку, оскільки робить
зловмиснику складнішим завдання підібрати seed навіть за наявності базових
12 чи 24 слів.
